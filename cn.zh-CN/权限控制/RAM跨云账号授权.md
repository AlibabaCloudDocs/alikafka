# RAM跨云账号授权

借助访问控制RAM的RAM角色，您可以跨云账号授权，使某个企业访问另一个企业的消息队列Kafka版。

企业A开通了消息队列Kafka版，该企业需要企业B代为操作消息队列Kafka版的资源，例如实例、Topic、Consumer Group。企业A的需求如下：

-   企业A希望能专注于业务系统，仅作为消息队列Kafka版所有者。企业A希望可以授权企业B来操作部分业务，例如：消息队列Kafka版的运维、监控以及管理等。
-   企业A希望当企业B的员工加入或离职时，无需做任何权限变更。企业B可以进一步将企业A的资源访问权限分配给企业B的RAM用户（员工或应用），并可以精细控制其员工或应用对资源的访问和操作权限。
-   企业A希望如果双方合同终止，企业A随时可以撤销企业B的授权。

## 步骤一：企业A创建RAM角色

使用企业A的阿里云账号登录RAM控制台为企业B的阿里云账号创建RAM角色。

1.  登录[RAM控制台](https://ram.console.aliyun.com/?spm=a2c4g.11186623.2.12.50234772TAoqT9)。

2.  在左侧导航栏，单击**RAM角色管理**。

3.  在**RAM角色管理**页面，单击**创建RAM角色**。

4.  在**创建RAM角色**面板，选择**阿里云账号**，单击**下一步**。

5.  在**角色名称**文本框，输入RAM角色名称，在**选择云账号**区域，选择**其他云账号**，输入企业B的阿里云账号的账号ID，然后单击**完成**。

    **说明：**

    -   RAM角色名称允许英文字母、数字和短划线（-），长度不超过64个字符。
    -   账号ID可以在**账号管理**控制台的**安全设置**页面查看。

## 步骤二：企业A为RAM角色添加权限

为RAM角色添加需要授予给企业B的访问消息队列Kafka版的权限。

1.  在RAM控制台的左侧导航栏，单击**RAM角色管理**。

2.  在**RAM角色管理**页面，找到创建的RAM角色，在其右侧**操作**列，单击**添加权限**。

3.  在**添加权限**面板的**选择权限**区域，选择策略类型，通过关键字搜索需要添加的权限策略 ，并单击权限策略将其添加至右侧的已选择列表中，然后单击**确定**。

    **说明：** 支持授予的访问消息队列Kafka版的权限策略请参见[RAM权限策略](/cn.zh-CN/权限控制/RAM权限策略.md)。

4.  在**添加权限**面板，查看授权信息，然后单击**完成**。


## 步骤三：企业B创建RAM用户

使用企业B的阿里云账号登录RAM控制台并创建RAM用户。

1.  登录[RAM控制台](http://ram.console.aliyun.com)。

2.  在左侧导航栏，选择**人员管理** \> **用户**。

3.  在**用户**页面，单击**创建用户**。

4.  在**创建用户**页面的**用户账号信息**区域的**登录名称**，输入登录名称，在**显示名称**文本框，输入显示名称。

    **说明：**

    -   登录名称允许英文字母、数字、英文句号（.）、下划线（\_）和短划线（-），长度不超过128个字符。
    -   显示名称长度不超过24个字符或汉字。
5.  如需创建多个RAM用户，单击**添加用户**，重复上一步。

6.  在**访问方式**区域，选择访问方式，然后单击**确定**。

    **说明：** 为提高安全性，建议您只为RAM用户选择一种访问方式。

    -   如果选择**控制台访问**，则需完成进一步设置，包括控制台密码设置、登录时是否要求重置密码、是否开启多因素认证。
    -   如果选择**编程访问**，则RAM会自动为RAM用户创建AccessKey。

        **说明：** 出于安全考虑，RAM控制台只提供一次查看或下载AccessKey Secret的机会，即创建AccessKey时，因此请务必将AccessKey Secret记录到安全的地方。

7.  在**手机验证**对话框，单击**获取验证码**，输入收到的手机验证码，然后单击**确定**。


## 步骤四：企业B为RAM用户添加权限

为RAM用户添加AliyunSTSAssumeRoleAccess的权限。

1.  在RAM控制台的左侧导航栏，选择**人员管理** \> **用户**。

2.  在**用户**页面，找到创建的RAM用户，在其右侧**操作**列，单击**添加权限**。

3.  在**添加权限**面板的**选择权限**区域，选择**系统策略**，输入AliyunSTSAssumeRoleAccess ，单击该权限策略将其添加至右侧的已选择列表中，然后单击**确定**。

4.  在**添加权限**面板，查看授权信息，然后单击**完成**。


企业B的RAM用户可以通过以下方式访问企业A的消息队列Kafka版。

-   控制台
    1.  在浏览器打开[RAM用户登录入口](https://signin.aliyun.com/login.htm)。
    2.  在**RAM用户登录**页面，输入RAM用户名称，单击**下一步**，输入RAM用户密码，然后单击**登录**。

        **说明：** RAM用户登录名称的格式为<$username\>@<$AccountAlias\>或<$username\>@<$AccountAlias\>.onaliyun.com。<$AccountAlias\>为账号别名，如果没有设置账号别名，则默认值为阿里云账号的ID。

    3.  在子用户用户中心页面，将鼠标指针移到右上角头像，在浮层单击**切换身份**。
    4.  在**阿里云－角色切换**页面，输入企业A的企业别名或默认域名，以及角色名，然后单击**切换**。

        **说明：**

        -   企业别名：使用企业A的阿里云账号在阿里云账号用户中心，将鼠标指针移到右上角头像，在浮层查看。
        -   默认域名：使用企业A的阿里云账号在RAM控制台的**设置**页面，单击**高级设置**页签查看。
-   API
    1.  调用AssumeRole接口获取AccessKey ID、AccessKey Secret和SecurityToken（临时安全令牌）。详情请参见[AssumeRole](/cn.zh-CN/API 参考（STS）/操作接口/AssumeRole.md)。
    2.  在代码中使用获取的AccessKey ID、AccessKey Secret和SecurityToken（临时安全令牌）调用API访问消息队列Kafka版。

